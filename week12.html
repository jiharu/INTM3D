<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8'>
<title>3D Modelling & Animation</title>
    
<link href="css/site.css" media="all" rel="stylesheet" type="text/css" />
<link href="css/highlight.default.css" media="all" rel="stylesheet" type="text/css" />
  
<script src="js/jquery.js"></script>
<script src="js/showdown.js" type="text/javascript"></script>

<link rel="icon" type="image/x-icon" href="favicon.ico" />
</head>
<body>
<!--
Write the markdown code below.
A guide to markdown syntax is at http://daringfireball.net/projects/markdown/
-->

<div style="display: none" id="sourcetext">

# Rendering

Rendering is the final step of the 3D animation pipeline and its quality is crucial to the strong completion of your project. Let's check out some more techniques which can make your final image distinguished.

## Ambient occlusion 

**Ambient occlusion** refers to the attenuation of indirect or diffuse light on an object. It refers to the darker areas of the object such as in creases, cracks, and crevices. Ambient occlusion is caused by indirect light's inability to bounce around and illuminate areas that are blocked by nearby features, that instead absorb the light rays. **These subtle variations in lighting are visual clues for our eyes to detect surface details and distinctions** that would otherwise be washed out and unnoticeable. Ambient occlusion adds realism to your scene by adding shadows in crevices, nooks and crannies, and so on. For each surface point, it calculates how much light is blocked by other geometry.

In the example below, the ice blocks stand out because of the shadowing between them. The cracks between the ice bricks appear darker because the light is blocked by the ice bricks' local geometry. 

![ao01](img/maya/rendering/comp_igloo_amb_occl_resized.png)

![amb](img/maya/rendering/Show_how_3D_real_time_ambient_occlusion_works.jpeg)  
Applying normal map, © CC BY-SA 3.0

When ambient light is used, objects in your scene may appear to be too bright and geometric detail may become lost. Ambient occlusion solves this problem by subtracting ambient light and thus adding shadowing.

![ao02](img/maya/rendering/comp_occlusion_2.png)![ao03](img/maya/rendering/comp_beautyHead_2.png)![ao03](img/maya/rendering/comp_beauty_occlusion_2.png)
![ao01](img/maya/rendering/comp_occlusion_rays_2.png)

## Creating ambient occlusion textures
There are several ways to apply ambient occlusion.  

### Toad objects
You can download the toad object files from here: [toad high resolution](obj/toad.obj), [toad low resolution](obj/toad_low.obj)

### Ambient occulusion using Arnold in Maya
 
- [Tutorial: Ambient occlusion using render layer.](https://www.youtube.com/watch?v=75JFUwA5XL0)

Or, you can apply the ***aiAmbientOcclusion*** Arnold shader directly to your object.

 ![ao01](img/maya/rendering/arnold/ao_01.png)
 
When you tweak ambient occlusion parameters, please check the [Arnold manual: ambient_occulson](https://support.solidangle.com/display/NodeRef/ambient_occlusion).   

 ![ao01](img/maya/rendering/arnold/ao_02.png)

 ![ao01](img/lab/toad_ao.jpg)   
Comparison: ambient occlusion surface shading using Mental Ray. 

## Baking a texture

You can "bake" lighting, texturing, and shadow information. Command location: in the "Rendering" module, go to Arnold/Utilities/Render Selection To Texture. 

 ![bk](img/maya/rendering/arnold/bk01.png) 

### Test image
![ao_com01](img/maya/rendering/comp.png)  
Image by Haru Ji.

## Creating textures with an occlusion map using Photoshop
- Once the bake is completed open the project file that you specified earlier.     
- In that folder, select your baked texture file and open this with Photoshop.      
- Drag the Occlusion bake on top of your model's texture layer(s) and select Multiply as the layer blending mode. You may also want to apply a slight Gaussian blur to your occlusion layer, especially if it being used on an organic surface. For hard sharp edged surfaces like this one no blur was applied.

### Creating textures for composition

You can download these images for your rendering practices. 

![ao05](img/lab/skin.png), ![ao02](img/lab/toad_bake.jpg)   
Initial skin map for the color map & ambient / bump map   

![ao03](img/lab/toad_color.jpg), ![ao04](img/lab/toad_specular.jpg)   
Color map & specular map.

### Applying baked maps to a high resolution surface.

![ao_com02](img/lab/toad_com01.jpg) 
Texturing on the high-res Toad geometry. All images by Haru Ji.


### Applying baked maps to a low resolution surface to create ***Level of Details***.

![ao_com03](img/lab/toad_com02.jpg) 
Texturing on the low-res Toad geometry.

### Blending different shaders in Arnold

The ***Mix Shader*** shader is used to blend or add two shaders (including light AOVs). It returns a linear interpolation of Shader1 and Shader2 according to the Mix Weight attribute. A Mix Weight value of 0 outputs Shader1, a value of 1 outputs Shader2, and a value of 0.5 mixes evenly between Shader1 and Shader2. 

![mx](img/maya/rendering/arnold/mx01.png)  
![mx](img/maya/rendering/arnold/mx02.png) 
Applying a chequer texture to the ***Mix Weight*** attribute of the ***aiMixShader***.

#### Blending examples 
![mx](img/maya/rendering/arnold/mx03.png) 
aiWireFrame + aiAmbientOcclusion  
 
![mx](img/maya/rendering/arnold/mx04.png)
aiWireFrame + aiStandardSurface (Jade preset)    

- [Arnold manual: mix shader](https://support.solidangle.com/display/A5AFMUG/Mix+Shader)  
- [Arnold manual: AOVs](https://support.solidangle.com/display/A5AFMUG/AOVs)  

### AOVs

AOVs (Arbitrary Output Variables) provide a way to render any arbitrary shading network component into different images. For example, an artist might find it convenient to separate direct and indirect lighting contributions and later recombine them during compositing. Arnold provides built-in AOVs for outputting depth, position, and motion vectors.   

 ![aovs](https://support.solidangle.com/download/attachments/65111838/image2017-9-19%2012%3A23%3A32.png?version=1&modificationDate=1505816612000&api=v2)  
 
- [Arnold manual: Light Path Expression AOVs](https://support.solidangle.com/display/A5ARP/Light+Path+Expression+AOVs)    

## Advanced topic: render layers and passes  

There are many techniques to create better quality  rendering. In particular, you can save time and energy and control your rendering result in detail by splitting up renders based on objects or shading components. You can even separate shadows from the rest of the scene or temporarily assign objects to specialized materials through the Render Layer Editor.

When a shot is animated in a 3D program for a professional production, it is rarely rendered out as is. Instead, the shot is divided into layers and/or render passes. In Maya, the Render Layer Editor allows you to create and manage various render layers and render passes.

### Render layer editor
Render layers can be used to separate the elements of a single scene into different versions or into different layers of a composite. Each layer can have its own shaders, lights, and settings. Using overrides, you can change the way each layer renders.

You can create and manage render layers using the Layer Editor in Render mode (called the Render Layer Editor). With render layers, you can assign any object to multiple layers with a different material on each layer. This lets you create multiple images for each frame, from any combination of Maya's four renderers, third party plug-in renderers, and post-processes such as Fur and Paint Effects.     

**A system of per layer and per object overrides** means that objects can have different shading and rendering attributes on different layers.    
With **render layers**, you can assign any object to multiple layers with a different material on each layer. This lets you create multiple images for each frame, from any combination of Maya's four renderers, third party plug-in renderers, and post- processes such as Fur and Paint Effects. Rendered images can be efficiently organized for output to a compositor. Render layers can be also be rendered to Adobe® Photoshop® (PSD) format, which supports multiple image layers.     

![rp01](img/maya/rendering/comp_car_luminance.png), ![rp02](img/maya/rendering/comp_car_shadow.png)
![rp03](img/maya/rendering/comp_car_reflection.png), 

Final realistic render image:

![ex01](img/maya/rendering/GUID-59AF3E15-AFFB-4ABE-BDCC-EED3B16B0B2F-low.png)

_________________________
# Visual effects

## Maya classic dynamics
Dynamics is a branch of physics that describes how objects move. Dynamic animation uses rules of physics to simulate natural forces. You specify the actions you want the object to take, then let the software figure out how to animate the object.

Dynamic animation lets you create realistic motion that's hard to achieve with traditional keyframe animation. For instance, you can make effects such as tumbling dice, waving flags, and exploding fireworks.

The Maya Dynamics guide, which provides information about creating dynamic simulations in Maya, is available at [http://www.autodesk.com/maya-docs-archive](http://www.autodesk.com/maya-docs-archive).

## nDynamics simulation framework
nDynamics is a dynamic simulation framework powered by Maya® Nucleus™ technology. A Maya Nucleus system is composed of a series of Nucleus objects, which consists of nCloth, nParticle, nHair, Soft Bodies, and passive collision objects, as well as dynamic constraints, and the Maya Nucleus solver.

## Effects Assets in the Visor
Effects Assets provides a number of preset effects that are organized as Maya assets. Effects Assets are available in the Visor window and can be quickly imported into your scene, applied to objects, then played and rendered with little or no modification. Effects Assets include 3D fluid effects, nParticles, nParticle emitters, and Maya fields, and provide effects such as explosions, fire, smoke, rain, and fireworks.

![ess](img/lab/esset.png)

Effects Assets are advanced assets, which allow them to be parented to objects outside the asset. For example, some assets, such as a fire asset, can be parented to a polygon object or applied as a surface emitter. Depending on the effect, selecting Effects Assets > Apply Effect from the FX menu set either parents the effect to an object, or applies it to a surface. Effects with Point or Volume emitters are parented while Surface emitter are applied. Free-standing effects, such as the Bomb.ma, do not need to be applied to objects in the scene. - [Maya help](http://help.autodesk.com/view/MAYAUL/2016/ENU/?guid=GUID-235C9A6C-42C9-4132-81BE-727B4A43AB1B)

![effect02](img/lab/effect01.png) 
Rendering image of Visor/nCloth Examples/PartyStreamers.ma
![effect03](img/lab/effect02.png) 
Rendering image of Visor/Fluid Examples/Nuke.ma

- [Maya help: Simulation and Effects](http://help.autodesk.com/view/MAYAUL/2016/ENU//index.html?guid=GUID-04EA8AE9-5081-426F-8122-D56461A69B0A)

## Ocean Shader & Bifrost

- [Maya Ocean shader test by LTKY823](https://www.youtube.com/watch?v=8fqUvntiuSw)  

### Bifröst

**Bifröst** is a procedural framework that can create simulated liquid effects using a FLIP (fluid implicit particle) solver. You can generate liquid from emitters and have it fall under gravity, interact with colliders to direct the flow and create splashes, and use accelerators to create jets and other effects.

![bifro](img/maya/rendering/bifrost.png)

- [bifrost simulation](http://www.igorfx.com/bifrost/)
- [knowledge.autodesk.com](http://knowledge.autodesk.com/support/maya/learn-explore/caas/CloudHelp/cloudhelp/2015/ENU/Maya/files/GUID-43D655E2-45A3-4FD8-847C-6622AF22995C-htm.html?v=2016)
- [simple tutorial](https://www.youtube.com/watch?v=ZrVW1Izzb7c)


---------------
## Paint effect

- [Maya Paint Effects Tutorial: Growing Animated Vines](https://www.youtube.com/watch?v=Y1ignag-NmY) 

**Paint Effects** is a powerful tool that allows you to interactively paint specialized strokes that create complex geometry as a post-process. Numerous Paint Effects brushes are included with Maya and are grouped in such categories as trees, flowers, weather, and fire.

![pe01](img/maya/pe/comp_butterflyhill.png)

You can use Paint Effects as a traditional paint program to paint images on a canvas, or to paint repeatable textures that you can apply to geometry in your scenes.

### Paint Effect attributes
After you create a Paint Effects stroke, you can edit the look and movement of the effect through the Attribute Editor. There are a large number of attributes to edit with Paint Effects.

- Select the stroke, and open the Attribute Editor. Switch to the stroke’s tab to the brush attributes.

-----------------------

## Post processing in Maya
### Depth of Field
Reference: Advanced Maya® Texturing and Lighting, Second Edition by Lee Lanier, 2008

Depth of field is the range of distances that encompass objects that appear acceptably sharp. Due to the optical nature of real-world lenses and the physical qualities of the atmosphere, photography and videography rarely produce images that are 100 percent in focus. In contrast, 3D renders are always in perfect focus unless artificial depth of field is used. 

You can activate Maya's depth of field by checking the Depth Of Field attribute in the Depth Of Field section of the camera's Attribute Editor tab. 

![dof00](img/maya/rendering/dof.png)    
[View the depth of field effect in Viewport 2.0](http://help.autodesk.com/view/MAYAUL/2016/ENU/?guid=GUID-93DFCF2E-1B24-4C4C-89FD-4C4C202746ED)   

![dof01](img/maya/rendering/dof01.png)  

The F Stop attribute roughly approximates the f-stop of real-world cameras. F-stop is a number that represents the ratio between the diameter of the lens aperture and the focal length of the lens. F-stops are scaled by an approximate factor of 1.4 (for example, f/1.4, f/2, f/2.8, and so on). Each increased f-stop halves the open area of the aperture, halves the amount of light striking the film, and increases the depth of field. The f-stop isn't the only factor to influence depth of field, however. Depth of field is inversely proportional to the focal length of the lens and directly proportional to the distance from the camera to the subject.
 
![dof02](img/maya/rendering/dof02.png)  
The Distance tool used to determine the focus distance.
   
![dof03](img/maya/rendering/dof03.png)   
An artificial depth of field is constructed by masking multiple copies of a render and applying different strength Gaussian blurs.

______________________
### Batch rendering
A batch file is a set of commands given to the computer to do, one after another. Using batch files, you can queue several rendering tasks at the same time, so that once one is finished, the next begins. Batch rendering often occurs as a different thread or process, as if it were a different program running in the background, so Maya allows you to keep working while the batch is rendering. 

Note that if you want to use Arnold batch rendering without watermarks in Maya, you need to purchase an Arnold license. Or alternatively you can render a sequence in Maya with the Render > Render Sequence command in the Render setting window; however you will not be able to use Maya while it is rendering.

__________________________


### Camera or airplane animation
When you add a camera or airplane to a scene, you should imagine how the shot will be composed and whether the camera will be animated. 

![path01](img/lab/motionpath03.png)
![path02](img/lab/motionpath02.png)  

- You can animate the camera using the 'Attach motion path' method, and keyframing on the 'aim vector' of the camera.  
- Or you can animate the camera and use the 'Set motion path key' method to make a motion path animation. 

### Using MEL (Maya Embedded Language) to create objects:

```
int $i;
int $j;
int $k;
int $n = 8; // decide the iteration number
int $d = 5; // control the distance
float $r = 4; // change the random value

for ($k = 0; $k < $n; $k++){ 
    for ($j = 0; $j < $n; $j++){
        for ($i = 0; $i < $n; $i++){
           polyCube -w 1 -h 1 -d 1 -name "poly"; //polySphere -r 1
           move -x ($i*$d+rand($r)) -y ($j*$d+rand($r)) -z ($k*$d+rand($r));
        }
    }
}
```

How to apply: write the MEL in the script editor, select them, and 'command + enter' to execute. 

### Camera crane animation

![crane](img/maya/deformer/crane.png) 

______________
## Digital Cinematography: optional
### Hardware rendering options for Playblast

![render](img/lab/hardwarerender.png)

### Camera	

![camera](img/maya/film/camera.png)

### Camera animation video tutorial
- [4 Tips for Camera Animation (for Maya or any other 3D software) by Bloop Animation](https://www.youtube.com/watch?v=b3PHRNvwl4A&t=3s) 


- [Camera Shake by Henry Medhurst](https://www.youtube.com/watch?v=6AS1PJlcHAE)    
	MEL expression for a simple shaking camera: 

```	
cameraShape1.horizontalShake = noise(frame*0.7)/30; 
```
	
Or 

```	
float $min = rand (-0.1, -0.3);  
float $max = rand (0.1, 0.3);  
if (frame <= 60){  
	camera1.translateX = rand($min, $max);  
	camera1.translateY = rand($min, $max);  
	camera1.translateZ = rand($min, $max);  
} else {  
	camera1.translateX = 0;  
	camera1.translateY = 0;  
	camera1.translateZ = 0;  
}  
```
__________
## Reference

[Maya 2018 online Help](http://help.autodesk.com/view/MAYAUL/2018/ENU//)    

- Art of Maya [pdf link](http://web.cse.ohio-state.edu/~parent/classes/682/MAYA/art_of_maya.pdf) 

## Inspiration
- 3D animated short films for your inspiration: 
	- [link 1](http://webneel.com/25-best-and-award-winning-3d-animated-short-films-your-inspiration)  
	- [link 2](https://www.shortoftheweek.com/channels/3d-animation/) 

______________________________________________

	
## One-on-one critique schedule
- Office location: 701G 205 Richmond.   
- Hours: [schedule link](https://docs.google.com/spreadsheets/d/1KsF1EU4VDf9GvXhQGYCOwKRV1lVfnV3EW_lT8WZUz10/edit?usp=sharing)  

## Project 3 - free theme modeling & rendering.
### Due date: Dec 17th midnight (Sunday 11:59pm).



</div>
<div id="wrapper">
	
	<div class="header">
		<h1>INTM3D</h1>		
		<a href="index.html">Class overview</a><br/>
		<a href=http://2017intm3d.tumblr.com/>Tumblr class portfolio</a><br/><br/>
	
		<h3>Class schedule</h3>	
				<a href="week01.html">1: Introduction</a><br/>
				<a href="week02.html">2: 3D modeling I</a><br/>
				<a href="week03.html">3: NURBS modeling</a><br/>
				<a href="week04.html">4: Polygon modeling</a><br/>
				<a href="week05.html">5: Shading</a><br/>								
				<a href="week06.html">6: Texturing</a><br/>  
				<a href="week07.html">7: Cinematography</a><br/>
				<a href="week08.html">8: Modeling techniques</a><br/>
				<a href="week09.html">9: Animation production</a><br/>
				<a href="week10.html">10: Basic animation</a><br/>		
				<a href="week11.html">11: Arnold: Physically Based Renderer</a><br/>
				<a href="week12.html">12: Rendering</a><br/>
	</div>
	<div class="section">
		<script type="text/javascript">
		//var converter = new Markdown.Converter();
		var converter = new Showdown.converter();
		document.write(converter.makeHtml($('#sourcetext').text()));
		</script>
	</div>
	
	<div class="footer">Haru (Hyunkyung) Ji, 2017</div>
	
</div>
</body>
</html>